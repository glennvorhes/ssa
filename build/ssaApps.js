!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=47)}([function(e,t,r){"use strict";function o(e){void 0===window.gv&&(window.gv={});for(var t=e.split("."),r=window.gv,o=0;o<t.length;o++){void 0===r[t[o]]&&(r[t[o]]={}),r=r[t[o]]}return r}Object.defineProperty(t,"__esModule",{value:!0}),o("util"),window.gv.util.provide=o,t.default=o},function(e,t){e.exports=$},function(e,t){e.exports=ol},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(32);t.mapPopup=new o.default,t.default=t.mapPopup},function(e,t,r){"use strict";function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}Object.defineProperty(t,"__esModule",{value:!0}),r(0).default("util").makeGuid=o,t.default=o},function(e,t,r){"use strict";function o(e,t,r){a.get(e,t,r,"json").fail(function(){var r="error getting: "+e+JSON.stringify(t);console.warn(r)})}function n(e,t,r,n){if(void 0===r&&(r={}),r[(1e6*Math.random()).toFixed()]=(1e6*Math.random()).toFixed(),"function"==typeof n){o(e,r,function(e){e=n(e),t(e)})}else o(e,r,t)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),s=a("#site-root").val();"5001"==window.location.port&&(s="http://localhost:5004/");var l=s+"getStartCounties",u=s+"getHighways",c=s+"getEndCounties",d=s+"getSegments",p=s+"getCorridor",h=s+"getCrashes",f=s+"getAllCounties",y=s+"getAllHighwaysForStartEndCounty",m=s+"getCcGeom",g=i.default("ssa"),_=function(e){return e.sort(function(e,t){return e.name==t.name?0:e.name<t.name?-1:1}),e},v=function(){function e(){throw"this class should not be instantiated"}return e.getStartCounties=function(e){n(l,e,{},_)},e.getHighways=function(e,t){n(u,t,{startCountyId:e})},e.getEndCounties=function(e,t){n(c,t,{highwayName:e},_)},e.getSegments=function(e,t,r){var o;o="string"==typeof t?parseInt(t):t;var i={routeid:o,county:e},s=a("#hidden-mm-version");s.length>0&&(i.mm=s.val()),n(d,r,i)},e.getCorridor=function(e,t,r){var o={from:e,to:t},i=a("#hidden-mm-version");i.length>0&&(o.mm=i.val()),n(p,r,o)},e.getCrashes=function(e,t,r){n(h,r,{ssaId:e,snapshot:t})},e.getAllCounties=function(e){n(f,e,{})},e.getHwyByStartEndCounty=function(e,t,r){n(y,r,{startCountyId:e,endCountyId:t})},e.getCcGeom=function(e,t,r){n(m,r,{ssaId:e,snapshot:t})},e}();t.AjaxGetters=v,t.default=v,g.AjaxGetters=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);t.proj4326=new o.proj.Projection({code:"EPSG:4326"}),t.proj3857=new o.proj.Projection({code:"EPSG:3857"}),t.proj3070=new o.proj.Projection({code:"EPSG:3070"})},function(e,t,r){"use strict";function o(){for(u.length==c.length&&(u=[]);;){var e=c[Math.floor(Math.random()*c.length)];if(u.indexOf(e)<0)return u.push(e),e}}function n(e,t,r){return{minZoom:4,name:e,transform:{dataProjection:a.proj3857,featureProjection:a.proj3857},style:new i.style.Style({stroke:new i.style.Stroke({color:t,width:6})}),visible:r}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(6),s=r(25),l=r(35);t.segmentLayer=new i.style.Style({stroke:new i.style.Stroke({color:"darkblue",width:5})}),t.fromSelectionColor="#48FD14",t.toSelectionColor="#EE0071",t.corridorPreviewColor="black";var u=[],c=["#FF00FF","#7FFF00","#FA8072","#FF6347","#40E0D0","#ADFF2F","#6495ED","#FF8C00","#7FFFD4","#DA70D6"];t.randomColor=o,t.layerConfigHelper=n,t.segNodeStyle=new i.style.Style({image:new i.style.RegularShape({radius:6,points:4,fill:new i.style.Fill({color:"rgb(0, 0, 0)"}),stroke:new i.style.Stroke({color:"rgb(0, 0, 0",width:2})})}),t.crashPointStyle=function(e){var t=e.getProperties(),r=s.default.getCrashColor(t.injSvr);if(!r)return null;var o=l.rgbToRgba(r,.6);return[new i.style.Style({image:new i.style.Circle({radius:6,fill:new i.style.Fill({color:o}),stroke:new i.style.Stroke({color:r,width:2})})})]}},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),i=r(0),a=r(2),s=r(1),l=r(6),u=r(6),c=i.default("layers"),d=function(e){function t(t,r){void 0===r&&(r={});var o=this;return t="string"==typeof t?t:"",o=e.call(this,t,r)||this,o._geoJsonFormat=new a.format.GeoJSON,o._transform=r.transform||{},o._transform.dataProjection=o._transform.dataProjection||l.proj4326,o._transform.featureProjection=o._transform.featureProjection||u.proj3857,(o.autoLoad||o.visible)&&o._load(),o}return o(t,e),t.prototype.addFeatures=function(e){this.source.addFeatures(this._geoJsonFormat.readFeatures(e,{dataProjection:this._transform.dataProjection,featureProjection:this._transform.featureProjection}))},t.prototype._load=function(){var t=this;return!!e.prototype._load.call(this)||(s.get(this._url,this._params,function(e){t.addFeatures(e),t.loadCallback(t)},"json").fail(function(){this._loaded=!1}),!1)},t.prototype.mapMoveCallback=function(t){e.prototype.mapMoveCallback.call(this,t),this._source.addFeatures(this._geoJsonFormat.readFeatures(t,{featureProjection:this._transform.featureProjection,dataProjection:this._transform.dataProjection}))},t}(n.LayerBaseVector);t.LayerBaseVectorGeoJson=d,c.LayerBaseVectorGeoJson=d,t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mmFlagListId="mm-deficiency-list",t.ccListId="cc-deficiency-list",t.pdpDataAttr="data-pdp-id",t.mmFlagColor="#00FF00",t.controllingCriteriaColor="#FFC632",t.propNames=["ccDesignSpeed","ccLaneWidth","ccShoulderWidth","ccHorizontalCurve","ccSuperelevation","ccMaximumGrade","ccStoppingSight","ccCrossSlope","ccVerticalClearance","ccDesignLoading"],t.propValues=["Design Speed","Lane Width","Shoulder Width","Horizontal Alignment","Superelevation","Grade","Stopping Sight Distance","Pavement Cross Slope","Vertical Clearance","Structural Capacity"],t.controllingCriteriaProps={};for(var o=0;o<t.propNames.length;o++)t.controllingCriteriaProps[t.propNames[o]]=t.propValues[o]},function(e,t,r){"use strict";function o(e){return{K:"rgb(255,0,0)",A:"rgb(255,165,0)",B:"rgb(255,255,0)",C:"rgb(153,255,153)",P:"rgb(141,227,230)"}[e]||"rgba(255,255,255,0)"}function n(e){return null==e||void 0===e?"":e}function i(e){return'<a class="crash-map-download" title="Download Crash Report" target="_blank" href="'+l+e+'"></a>'}function a(e){e.sort(function(e,t){var r=new Date(e.dte+" "+e.time).getTime(),o=new Date(t.dte+" "+t.time).getTime();return r==o?0:r>o?-1:1});var t="";t+='<ul class="crash-list">';for(var r={},n=0,a=e;n<a.length;n++){var s=a[n];void 0===r[s.injSvr]?r[s.injSvr]=1:r[s.injSvr]++,t+='<li style="background-color: '+o(s.injSvr)+';">',c&&(t+=i(s.doctnmbr)),t+=s.accDate?s.accDate:"",s.mnrColl&&(t+=", "+s.mnrColl),s.injSvr&&(t+=", "+s.injSvr),t+="</li>"}t+="</ul>";var l={K:"Fatal",A:"Incapacitating",B:"Non-incapacitating",C:"Possible Injury",P:"Property Damage"},u='<table class="crash-summary-table">';if(u+='<tr><th colspan="2">Crash Summary</th></tr>',u+="<tr><td>Total</td><td>"+e.length+"</td></tr>",e.length>0)for(var d=0,p=["K","A","B","C","P"];d<p.length;d++){var h=p[d];void 0!==r[h]&&(u+="<tr><td>"+l[h]+"</td><td>"+r[h]+"</td></tr>")}return u+="</table>",t=u+t}Object.defineProperty(t,"__esModule",{value:!0});var s=r(1),l="https://transportal.cee.wisc.edu/applications/crash-reports/retrieveCrashReport.do?doctnmbr=",u=s("#hidden-show-crash-report"),c=!1;if(u){var d=u.val();"string"==typeof d&&"y"==d.toLowerCase().trim()&&(c=!0)}t.mmPopupContent=function(e){var t='<table class="mm-popup-table">';return t+="<tr><td>PdpId</td><td>"+e.pdpId+"</td></tr>",t+="<tr><td>Highway</td><td>"+e.stdName+"</td></tr>",t+="<tr><td>Description</td><td>"+(e.rpDesc?e.rpDesc:"-")+"</td></tr>",t+="<tr><td>Divided</td><td>"+e.divUnd+"</td></tr>",t+="<tr><td>From RP</td><td>"+e.startRp+"</td></tr>",t+="<tr><td>To RP</td><td>"+e.endRp+"</td></tr>",t+="</table>"};var p=["doctnmbr","accDate","ntfyHour","county","municipality","munitype","onHwyRp","onHwyDir","onStr","athHwy","atStr","intDir","intDis","accdSvr","injSvr","totFatl","toInj","accdType","mnrColl","accdLoc","hwyClass","roadCond","wthrCond","consZone","alcFlag","bikeFlag","cyclFlag","pedFlag","totVeh","lon","lat"];t.crashPointPopup=function(e){for(var t='<table class="crash-popup-table">',r=0;r<p.length;r++){var o=p[r],a=n(e[o]);0==r&&c&&(a='<span style="margin-right: 3px">'+a+"</span>"+i(a)),t+="<tr><td>"+o+"&nbsp;&nbsp;</td><td>"+a+"</td></tr>"}return t+="</table>"},t.crashInfoHelper=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),n=r(0),i=n.default("domUtil"),a=function(){function e(e,t,r){var n=this,i=o.default(),a=o.default(),s='<div id="'+i+'">';if(s+='<label for="'+a+'">'+t+"</label>",s+=r?r(a):'<select id="'+a+'"></select>',s+="</div>",e.append(s),this._$container=e.find("#"+i),this.$label=this._$container.find("label"),this._changeListeners=[],this._box=e.find("#"+a),!this._box)throw"the select box was not found";this._box.change(function(){n.changed()})}return Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),e.prototype.changed=function(){for(var e=this._box.val(),t=0,r=this._changeListeners;t<r.length;t++){(0,r[t])(e)}},e.prototype.addChangeListener=function(e){this._changeListeners.push(e)},Object.defineProperty(e.prototype,"selectedValue",{get:function(){var e=this.box.val();return null==e||void 0===e?null:isNaN(e)?e:e.indexOf(".")>-1?parseFloat(e):parseInt(e)},set:function(e){this.box.val(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedText",{get:function(){return this.box.find("option:selected").text()},enumerable:!0,configurable:!0}),e}();t.SelectBoxBase=a,i.SelectBoxBase=a,t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=o.default("olHelpers"),i=function(){function e(e,t){if(this.sortedFeatures=e,this.propertyName=t,this.sortedFeatures.length>0){this._propertyType=typeof this.sortedFeatures[0].getProperties()[this.propertyName];var r=this;this.sortedFeatures.sort(function(e,t){if("number"==r._propertyType){var o=e.getProperties()[r.propertyName]-t.getProperties()[r.propertyName];return 0==o?0:o>0?1:-1}if("string"==r._propertyType){var n=e.getProperties()[r.propertyName]||"",i=t.getProperties()[r.propertyName]||"";return n=n.toString().trim(),i=i.toString().trim(),n==i?0:n>i?1:0}})}}return e.prototype.getFeature=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=this.sortedFeatures),0!=r.length){if(1==r.length)return t?r[0].getProperties()[this.propertyName]==e?r[0]:void 0:r[0];var o=r[0].getProperties()[this.propertyName],n=r[r.length-1].getProperties()[this.propertyName];if(t){if(o==e)return r[0];if(e<o)return;if(n==e)return r[r.length-1];if(e>n)return}else{if(e<=o)return r[0];if(e>=n)return r[r.length-1]}var i=Math.floor(r.length/2),a=r[i],s=a.getProperties()[this.propertyName];return s===e?a:e<s?this.getFeature(e,t,r.slice(0,i)):this.getFeature(e,t,r.slice(i))}},e}();n.SortedFeatures=i,t.default=i},function(e,t,r){"use strict";function o(e){for(var t=!1,r=1e101,o=1e101,n=-1e101,i=-1e101,a=0,s=e;a<s.length;a++){var l=s[a],u=l.olLayer||l;if(u.getSource().getFeatures().length>0){t=!0;var c=u.getSource().getExtent();r=c[0]<r?c[0]:r,o=c[1]<o?c[1]:o,n=c[2]>n?c[2]:n,i=c[3]>i?c[3]:i}}return t?[r,o,n,i]:void 0}function n(e,t,r){var n=o(e);void 0!==n&&(t.getView().fit(n,t.getSize()),"number"==typeof r&&t.getView().setZoom(t.getView().getZoom()-r))}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=i.default("util");t.calculateExtent=o,a.calculateExtent=o,t.fitToMap=n,a.calculateExtent=o},function(e,t,r){"use strict";function o(e){return String(e).replace(/[&<>"'\/]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"}[e]})}function n(e,t){return e.substring(0,7)+" - "+t.substring(0,7)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),a=r(4),s=r(0),l=r(7),u=r(5),c=r(12),d=r(7),p=r(13),h=r(2),f=s.default("ssa"),y=function(){function e(e,t,r,o,s,u,p,h,f){if(void 0===f&&(f={}),this.ssaId=-1,this.snapshotVersion=-1,this.corridorId=-1,f.features=f.features?f.features:void 0,f.cancelLoad="boolean"==typeof f.cancelLoad&&f.cancelLoad,this.clientId=a.default(),f.color?this._color=f.color:this._color=l.randomColor(),this.databaseId=f.databaseId||void 0,this._valid=!1,this._error="",this._loaded=!1,this.sortedFeatures=null,this.pdpFrom=e,this.pdpTo=t,this.countyStart="string"==typeof s?parseInt(s):s,this.countyEnd="string"==typeof u?parseInt(u):u,this.routeId="string"==typeof h?parseInt(h):h,this.highway=p,this.rpFrom=r,this.rpTo=o,"number"!=typeof h)throw"route id is not number";this._corridorLayer=new i.LayerBaseVectorGeoJson("",l.layerConfigHelper(n(this.rpFrom,this.rpTo),this._color,!0)),this.nodeLayer=new i.LayerBaseVectorGeoJson("",{style:d.segNodeStyle,minZoom:11,zIndex:3}),f.features?this._corridorLayer.source.addFeatures(f.features):f.jsonFeatures?(this._corridorLayer.addFeatures(f.jsonFeatures),this._loaded=!0,this.sortedFeatures=new c.default(this.olLayer.getSource().getFeatures(),"pdpId"),this.buildNodes()):f.cancelLoad||this.load(f.loadedCallback)}return e.prototype.setDbValues=function(e){this.ssaId=e.ssaId,this.snapshotVersion=e.snapshotVersion,this.corridorId=e.corridorId},e.prototype.load=function(e){var t=this;e="function"==typeof e?e:function(){},this._valid=!1,this._error="",u.default.getCorridor(this.pdpFrom,this.pdpTo,function(r){t._corridorLayer.addFeatures(r),void 0===r.error?t._valid=!0:t._error=r.error,t._loaded=!0,t.sortedFeatures=new c.default(t.olLayer.getSource().getFeatures(),"pdpId"),t.buildNodes(),e(t)})},e.prototype.buildNodes=function(){this.nodeLayer.clear();for(var e=this._corridorLayer.olLayer.getSource().getFeatures(),t=0;t<e.length;t++){var r=e[t].getGeometry().getCoordinates();if(r&&r.length>0){var o=new h.geom.Point(r[0]),n=new h.geom.Point(r[r.length-1]);this.nodeLayer.olLayer.getSource().addFeature(new h.Feature(o)),this.nodeLayer.olLayer.getSource().addFeature(new h.Feature(n))}}},e.prototype.clone=function(){var t=new e(this.pdpFrom,this.pdpTo,this.rpFrom,this.rpTo,this.countyStart,this.countyEnd,this.highway,this.routeId,{features:this.features});return t.buildNodes(),t},e.prototype.updateCorridor=function(e){this.pdpFrom=e.pdpFrom,this.pdpTo=e.pdpTo,this.countyStart=e.countyStart,this.countyEnd=e.countyEnd,this.highway=e.highway,this.rpFrom=e.rpFrom,this.rpTo=e.rpTo,this.routeId=e.routeId,this.layer.name=n(this.rpFrom,this.rpTo),this.layer.clear(),this.layer.olLayer.getSource().addFeatures(e.features),this.buildNodes()},Object.defineProperty(e.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableHtmlCreate",{get:function(){var e='<tr class="corridor-tr">';return e+='<td style="background-color: '+this._color+'"></td>',e+="<td>"+n(this.rpFrom,this.rpTo)+"</td>",e+="<td>",e+='<span title="Zoom To" class="corridor-zoom" data-corridor="'+this.clientId+'"></span>',e+='<span title="Edit Corridor"  class="corridor-edit" data-corridor="'+this.clientId+'"></span>',e+='<span title="Remove Corridor"  class="corridor-delete" data-corridor="'+this.clientId+'"></span>',e+="</td>",e+="</tr>"},enumerable:!0,configurable:!0}),e.prototype.getDataHtml=function(e){var t='<div class="corridor-data">';return t+="<label>Ssa Id</label>",t+='<input type="text" readonly class="corridor-data-ssa-id" name="corridors['+e+'].id.ssaId" value="'+this.ssaId+'"><br>',t+="<label>Snapshot version</label>",t+='<input type="text" readonly class="corridor-data-snapshot" name="corridors['+e+'].id.snapshotVersion" value="'+this.snapshotVersion+'"><br>',t+="<label>Corridor Id</label>",t+='<input type="text" readonly class="corridor-data-corridor-id" name="corridors['+e+'].id.corridorId" value="'+this.corridorId+'"><br>',t+="<label>Start County</label>",t+='<input type="text" class="corridor-data-start-county" readonly name="corridors['+e+'].startCounty" value="'+this.countyStart+'"/><br>',t+="<label>End County</label>",t+='<input type="text" class="corridor-data-end-county" readonly name="corridors['+e+'].endCounty" value="'+this.countyEnd+'"/><br>',t+="<label>Highway</label>",t+='<input type="text" class="corridor-data-highway" readonly name="corridors['+e+'].stdhighway" value="'+this.highway+'"/><br>',t+="<label>Start Rp</label>",t+='<input type="text" class="corridor-data-from-rp" readonly name="corridors['+e+'].startRp" value="'+this.rpFrom+'"/><br>',t+="<label>End Rp</label>",t+='<input type="text" class="corridor-data-to-rp" readonly name="corridors['+e+'].endRp" value="'+this.rpTo+'"/><br>',t+="<label>Route Id</label>",t+='<input type="text" class="corridor-data-route-id" readonly name="corridors['+e+'].rdwyRteId" value="'+this.routeId+'"/><br>',t+="<label>Start Pdp</label>",t+='<input type="text" class="corridor-data-from-pdp" readonly value="'+this.pdpFrom+'"/><br>',t+="<label>End Pdp</label>",t+='<input type="text" class="corridor-data-to-pdp" readonly value="'+this.pdpTo+'"/><br>',t+="</div>"},e.prototype.getDataHtmlDisp=function(e){var t=this.getDataHtml(e);return t=o(t),t=t.replace(/&quot;&#x2F;&gt;/g,"&quot;&#x2F;&gt;<br>"),(t=t.replace(/corridor-data&quot;&gt;/g,"corridor-data&quot;&gt;<br>"))+"<br>"},Object.defineProperty(e.prototype,"olLayer",{get:function(){return this._corridorLayer.olLayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layer",{get:function(){return this._corridorLayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._corridorLayer.visible},set:function(e){this._corridorLayer.visible=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"features",{get:function(){return this._corridorLayer.features},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extent",{get:function(){return p.calculateExtent([this.layer])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),e}();f.Corridor=y,t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(1),i=o.default("ssa"),a=function(){function e(e,t,r){var o=this;this._topCheck=n("#"+e),this._subChecks=n("."+t),this._changeCallbacks=[],this._onValues=[],this._allValues=[],this._subChecks.each(function(e,t){o._allValues.push(n(t).val())}),this._topCheck.prop("checked",r),this._setAllOnOff(r),this._topCheck.change(function(){o._setAllOnOff(o._topCheck.prop("checked"))});var i=this;this._subChecks.change(function(){var e=n(this),t=e.val(),r=e.prop("checked"),o=i._onValues.indexOf(t);r&&o==-1?i._onValues.push(t):r||o==-1||i._onValues.splice(o,1),i._topCheck.prop("checked",i._onValues.length==i._allValues.length),i._fireCallbacks()})}return e.prototype.addChangeCallback=function(e){this._changeCallbacks.push(e)},e.prototype.valIsOn=function(e){return this._onValues.indexOf(e)>-1},e.prototype._setAllOnOff=function(e,t){if(void 0===t&&(t=!0),this._subChecks.prop("checked",e),this._onValues=[],e)for(var r=0,o=this._allValues;r<o.length;r++){var n=o[r];this._onValues.push(n)}t&&this._fireCallbacks()},e.prototype._fireCallbacks=function(){for(var e=0,t=this._changeCallbacks;e<t.length;e++){(0,t[e])()}},Object.defineProperty(e.prototype,"allValues",{get:function(){for(var e=[],t=0,r=this._allValues;t<r.length;t++){var o=r[t];e.push(o)}return e},enumerable:!0,configurable:!0}),e}();i.FilterBase=a,t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(34),n=r(0),i=r(4),a=r(1),s=n.default("layers"),l=function(){function e(e,t){if(void 0===t&&(t={}),t=t||{},"string"!=typeof e)throw"Invalid URL";this._url=e,this._params="object"==typeof t.params?t.params:{},this._legendCollapse="boolean"==typeof t.legendCollapse&&t.legendCollapse,this._legendCheckbox="boolean"!=typeof t.legendCheckbox||t.legendCheckbox,this.id=t.id||i.default(),this._name=t.name||"Unnamed Layer",this.animate=!1,this._opacity="number"==typeof t.opacity?t.opacity:1,this._opacity>1?this._opacity=1:this._opacity<0&&(this._opacity=0),this._visible="boolean"!=typeof t.visible||t.visible,this._source=void 0,this._olLayer=void 0,this._loaded=!1,this._maxResolution=o.zoomToResolution(t.minZoom),void 0!==this._maxResolution&&(this._maxResolution+=1e-5),this._minResolution=o.zoomToResolution(t.maxZoom),this._minZoom="number"==typeof t.minZoom?t.minZoom:void 0,this._maxZoom="number"==typeof t.maxZoom?t.maxZoom:void 0,this._zIndex="number"==typeof t.zIndex?t.zIndex:0,this.loadCallback="function"==typeof t.loadCallback?t.loadCallback:function(){},this._legendContent="",this._legendCheckbox?(this._legendContent+='<input type="checkbox" '+(this.visible?"checked":"")+' class="legend-check" id="'+this.id+'-legend-layer-check"><span></span>',this._legendContent+='<label for="'+this.id+'-legend-layer-check" class="legend-layer-name">'+this.name+"</label>"):this._legendContent+='<label class="legend-layer-name">'+this.name+"</label>",this._$legendDiv=null,this._applyCollapseCalled=!1,this._addLegendContent("string"==typeof t.legendContent?t.legendContent:void 0)}return e.prototype._load=function(){return 1==this.loaded||(this._loaded=!0,!1)},e.prototype.getLegendDiv=function(){return'<div class="legend-layer-div" id="'+this.id+'-legend-layer-div">'+this._legendContent+"</div>"},e.prototype._addLegendContent=function(e){void 0===e&&(e=""),e.indexOf("<ul>")>-1&&(e='<span class="legend-items-expander" title="Expand/Collapse">&#9660;</span>'+e),this._legendContent+=e,this._$legendDiv=a("#"+this.id+"-legend-layer-div"),this._$legendDiv.length>0&&(this._$legendDiv.append(e),this.applyCollapse())},e.prototype.addLegendContent=function(e){this._addLegendContent(e)},e.prototype.applyCollapse=function(){if(this._applyCollapseCalled)return void console.log("collapse already applied");if(this._$legendDiv=a("#"+this.id+"-legend-layer-div"),this._$legendDiv.length>0){var e=this._$legendDiv.find(".legend-items-expander");e.length>0&&(this._applyCollapseCalled=!0,e.click(function(){var e=a(this);e.siblings("ul").slideToggle(),e.hasClass("legend-layer-group-collapsed")?(e.removeClass("legend-layer-group-collapsed"),e.html("&#9660;")):(e.addClass("legend-layer-group-collapsed"),e.html("&#9654;"))}),this._legendCollapse&&e.trigger("click"))}},e.prototype.refresh=function(){this.source&&this.source.refresh()},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animate",{get:function(){return this._animate},set:function(e){this._animate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"legendContent",{get:function(){return this._legendContent},set:function(e){this._legendContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"params",{get:function(){return this._params},set:function(e){this._params=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minResolution",{get:function(){return this._minResolution},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResolution",{get:function(){return this._maxResolution},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minZoom",{get:function(){return this._minZoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxZoom",{get:function(){return this._maxZoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){this.setVisible(e)},enumerable:!0,configurable:!0}),e.prototype.setVisible=function(e){this._visible=e,this.olLayer&&(this.olLayer.setVisible(this._visible),e&&!this._loaded&&this._load())},Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=e,this.olLayer&&this.olLayer.setOpacity(this._opacity)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this.getSource()},enumerable:!0,configurable:!0}),e.prototype.getSource=function(){return this._source},Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e},enumerable:!0,configurable:!0}),e.prototype.setZIndex=function(e){},Object.defineProperty(e.prototype,"olLayer",{get:function(){return this.getOlLayer()},enumerable:!0,configurable:!0}),e.prototype.getOlLayer=function(){return this._olLayer},e}();t.LayerBase=l,s.LayerBase=l,t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=o.default("olHelpers"),i=function(){function e(e){this._map=null,this._initialized=!1,this._subtype=e}return e.prototype.init=function(e){this._initialized||(this._map=e,this._initialized=!0)},Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialized",{get:function(){return this._initialized},enumerable:!0,configurable:!0}),e.prototype._checkInit=function(){if(!this.initialized){var e=this._subtype+" object not initialized";throw alert(e),console.log(e),e}},e.prototype.checkInit=function(){this._checkInit()},e}();t.MapInteractionBase=i,n.MapInteractionBase=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(31);t.mapMove=new o.default,t.default=t.mapMove},function(e,t,r){"use strict";function o(e){void 0===e&&(e={});var t=n.quickMapBase(e);return a.default.init(t),s.default.init(t),t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=r(0),a=r(18),s=r(3),l=i.default("olHelpers");t.quickMap=o,l.quickMap=o,t.default=o},function(e,t,r){"use strict";function o(e){return void 0===e||null===e}function n(e){return!o(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=i.default("util.checkDefined");t.undefinedOrNull=o,a.undefinedOrNull=o,t.definedAndNotNull=n,a.definedAndNotNull=n},function(e,t,r){"use strict";function o(e){for(var t=[],r=0,o=Object.keys(e);r<o.length;r++){var n=o[r];t.push({key:n,value:e[n]})}return t.sort(function(e,t){return e>t?1:-1}),t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=n.default("util");t.keyValPairs=o,i.keyValPairs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),n=r(0),i=r(1),a=n.default("ssa"),s=function(){function e(e){this.$mainContainer=i("#"+e),this.$mainContainer.addClass("ssa-map-container"),this._mapId=o.default(),this.$mainContainer.append('<div id="'+this._mapId+'" class="ssa-main-map"></div>'),i(".ol-zoom-out").html("&#8211;"),this.mainMapMove=void 0,this.mainMapPopup=void 0}return Object.defineProperty(e.prototype,"mapId",{get:function(){return this._mapId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$mapDiv",{get:function(){return i("#"+this.mapId)},enumerable:!0,configurable:!0}),e}();t.SsaMapBase=s,a.SsaMapBase=s,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(8),n=r(12),i=r(9),a=r(1),s=function(){function e(e,t,r,n){this.deficiencyLayer=new o.default("",{zIndex:r,name:e}),this.deficiencyLayer.style=t,this._sortedFeatures=void 0,this._map=void 0,this._summaryListId=n,this.$summaryList=void 0}return e.prototype.init=function(e){this._map=e,e.addLayer(this.deficiencyLayer.olLayer),this.$summaryList=a("#"+this._summaryListId)},e.prototype.addCorridor=function(e){},e.prototype.getFeatureById=function(e){return this._sortedFeatures.getFeature(e)},e.prototype.afterLoad=function(){this._sortedFeatures=new n.default(this.deficiencyLayer.features,"pdpId");var e=this;this.$summaryList.find("li").click(function(){var t=a(this),r=e.getFeatureById(parseInt(t.attr(i.pdpDataAttr)));e._map.getView().fit(r.getGeometry().getExtent(),e._map.getSize()),e._map.getView().setZoom(e._map.getView().getZoom()-1)})},e}();t.default=s},function(e,t,r){"use strict";function o(e,t){var r='<div class="col-xs-2">';return r+="<label>"+e+"</label>",r+='<input class="form-control" type="text" readonly="" value="'+t+'">',r+="</div>"}Object.defineProperty(t,"__esModule",{value:!0});var n=r(41),i=r(1),a=function(){function e(e){e.val||(e=i(e)),this.ssaId=parseInt(e.find(".corridor-data-ssa-id").val()),this.snapshotVersion=parseInt(e.find(".corridor-data-snapshot").val()),this.corridorId=parseInt(e.find(".corridor-data-corridor-id").val()),this.startCounty=parseInt(e.find(".corridor-data-start-county").val()),this.endCounty=parseInt(e.find(".corridor-data-end-county").val()),this.hgwy=e.find(".corridor-data-highway").val(),this.startRp=e.find(".corridor-data-from-rp").val(),this.endRp=e.find(".corridor-data-to-rp").val(),this.startPdp=parseInt(e.find(".corridor-data-from-pdp").val()),this.endPdp=parseInt(e.find(".corridor-data-to-pdp").val()),this.routeId=parseInt(e.find(".corridor-data-route-id").val())}return e.prototype.bootstrapHtml=function(e){e++;var t='<div class="row ssa-corridor-info-row">';return t+='<div class="col-xs-2">',t+="<label>Corridor #"+e+"</label>",t+="</div>",t+=o("Highway",this.hgwy),t+=o("Start County",n.getCountyById(this.startCounty)),t+=o("End County",n.getCountyById(this.endCounty)),t+=o("Start RP",this.startRp),t+=o("End RP",this.endRp),t+="</div>"},e.prototype.toString=function(){return"CorId "+this.corridorId+" "+this.startRp+" - "+this.endRp},e}();t.default=a},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),i=function(e){function t(){return e.call(this,"filter-crash","filter-crash-sub",!1)||this}return o(t,e),t.prototype.getCrashColor=function(t){return e.prototype.valIsOn.call(this,t)?{K:"rgb(255,0,0)",A:"rgb(255,165,0)",B:"rgb(255,255,0)",C:"rgb(153,255,153)",P:"rgb(0,0,255)"}[t]||"rgb(128,128,128)":null},t}(n.default);t.FilterCrash=i,t.default=new i},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),i=r(19),a=r(3),s=r(4),l=r(0),u=r(37),c=r(36),d=r(1);r(1);var p=l.default("ssa"),h=function(e){function t(t,r,o){var n=e.call(this,t)||this;n.$mainContainer.prepend('<div class="ssa-map-sidebar"></div>'),n.mainMap=i.default({divId:n.mapId,minZoom:6,zoom:6,fullScreen:!0}),n.mainMapPopup=a.default,n.$sideBar=n.$mainContainer.find(".ssa-map-sidebar");var l=function(){n._afterChange()};n.pickerCollection=new u.default(n.$sideBar,n.mainMap);var d=s.default();return n.$sideBar.append('<div id="'+d+'"></div>'),n.corridorCollection=new c.default(n.$sideBar,n.mainMap,r,l,o),n.pickerCollection.corridorCollection=n.corridorCollection,n.corridorCollection.loadExistingCorridors(),n}return o(t,e),t.prototype._afterChange=function(){var e=this;this.corridorCollection.$innerContainer.find(".corridor-zoom").click(function(){var t=d(this).attr("data-corridor"),r=e.corridorCollection.getCorridorById(t);e.mainMap.getView().fit(r.extent,e.mainMap.getSize())}),this.corridorCollection.$innerContainer.find(".corridor-delete").click(function(){var t=d(this).attr("data-corridor");e.corridorCollection.removeCorridor(t)}),this.corridorCollection.$innerContainer.find(".corridor-edit").click(function(){e.pickerCollection.$createCorridorButton.prop("disabled",!0);var t=d(this).attr("data-corridor"),r=e.corridorCollection.getCorridorById(t);e.pickerCollection.startPicker(r),d(this).closest(".corridor-tr").addClass("corridor-tr-selected")})},t}(n.default);t.SsaMapCreate=h,p.SsaMapCreate=h,window.SsaMapCreate=h,t.default=h},function(e,t,r){"use strict";function o(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],{name:"IE",version:e[1]||""}):"Chrome"===r[1]&&null!=(e=t.match(/\bOPR|Edge\/(\d+)/))?{name:"Opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})}var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(22),a=r(19),s=r(3),l=r(0),u=r(24),c=r(14),d=r(13),p=r(39),h=r(40),f=r(38),y=r(9),m=r(5),g=r(1),_=r(10),v=l.default("ssa"),b=function(e){var t=_.mmPopupContent(e);return t+=p.default.getCrashSummary(e.pdpId)},C=function(e){function t(t,r,n){var i=e.call(this,t)||this;i._ssaId=parseInt(g("#hidden-ssa-id").val()),i._snap=parseInt(g("#hidden-snapshot-id").val()),i.$getMapButton=g("#download-map-image"),i.getMapLinkId="get-map-link",i.mapImageName="map-image-id-"+i._ssaId+"-ver-"+i._snap+".png";var l='<a id="'+i.getMapLinkId+'" href="#" download="'+i.mapImageName+'" style="display: none"></a>';g("#"+i.mapId).append(l),i.mainMap=a.default({divId:i.mapId,minZoom:6,zoom:6,fullScreen:!0});var d='<div class="segment-index-summary">';d+='<div class="segment-index-summary-toggles">',d+='<span class="segment-index-summary-toggle segment-index-summary-zoom" title="Zoom To Initial Extent">&#8634;</span>',d+='<span class="segment-index-summary-toggle segment-index-summary-close" title="Hide Legend">&#8598;</span>',d+='<span class="segment-index-summary-toggle segment-index-summary-open" title="Show Legend">&#8600;</span>',d+="</div>",d+='<h4 style="color: '+y.mmFlagColor+'">Metamanager Flags</h4>',d+='<ul id="'+y.mmFlagListId+'"></ul>',d+='<h4 style="color: '+y.controllingCriteriaColor+'">Controlling Criteria</h4>',d+='<ul id="'+y.ccListId+'"></ul>',d+="</div>",i.$mapDiv.append(d);var p=i.$mapDiv.find(".segment-index-summary"),_=p.find(".segment-index-summary-close"),v=p.find(".segment-index-summary-open"),C=p.find(".segment-index-summary-zoom");v.hide();var P=!1,w=p.width(),L=p.css("min-height"),S=p.css("padding");_.click(function(){P||(P=!0,p.find("ul, h3, h4, h5").fadeOut(100,function(){p.css("padding","2px"),p.width("auto"),p.css("min-height","auto"),_.hide(),v.show(),P=!1}))}),v.click(function(){P||(P=!0,p.css("padding",S),p.width(w),p.css("min-height",L),p.find("ul, h3, h4, h5").fadeIn(100,function(){_.show(),v.hide(),P=!1}))}),C.click(function(){i._fitExtent()}),i.mainMapPopup=s.default,r="string"==typeof r?r:"corridor-data",n="string"==typeof n?n:"ssa-corridor-info-anchor",r="."+r,g(i.mainMap.getTargetElement()).append('<div class="crashes-loaded-msg">Crashes Loaded</div>');var k=[];i._corridorArray=[],g(r).each(function(e,t){k.push(new u.default(t))}),i.createdCorridorsLength=k.length,i.loadedCorridorsLength=0;var x={},O=[];return m.default.getCcGeom(i._ssaId,i._snap,function(e){for(var t=0,r=e.features;t<r.length;t++){var o=r[t],a=o.properties.corridorId.toFixed();x[a]||(O.push(a),x[a]={crs:e.crs,type:e.type,features:[]}),x[a].features.push(o)}for(var s="",l=0;l<O.length;l++){var u=k[l];s+=u.bootstrapHtml(l);var d=new c.default(u.startPdp,u.endPdp,u.startRp,u.endRp,u.startCounty,u.endCounty,u.hgwy,u.routeId,{color:"black",jsonFeatures:x[l.toFixed()]});h.default.addCorridor(d),f.default.addCorridor(d),i._corridorArray.push(d),i.mainMap.addLayer(d.olLayer),i.mainMap.addLayer(d.nodeLayer.olLayer),i.mainMapPopup.addVectorPopup(d.layer,b)}i._afterCorridorLoad(),g("#"+n).after(s)}),h.default.init(i.mainMap),f.default.init(i.mainMap),i.$getMapButton.click(function(){var e=o();console.log("browser name: "+e.name+", version: "+e.version);var t=!1;if(e.name.search(/IE?/)>-1&&(t=!0,parseInt(e.version)<11))return void alert("Unsupported Browser\nUpgrade to Internet Explorer 11 or use Firefox or Chrome");var r=i.mainMap.getTargetElement(),n=r.style.height,a=r.style.width,s=r.style.position,l=i.mainMap.getView().getCenter(),u=i.mainMap.getView().getZoom(),c=1800;r.style.height=c+"px",r.style.width=c+"px",r.style.position="absolute",i.mainMap.once("postrender",function(){i._fitExtent(),setTimeout(function(){i.mainMap.once("postcompose",function(e){try{var o=e.context.canvas,c=o.toDataURL("image/png");if(t)window.navigator.msSaveBlob(o.msToBlob(),i.mapImageName);else{var d=document.getElementById(i.getMapLinkId);d.href=c,d.click(),d.href="#"}r.style.height=n,r.style.width=a,r.style.position=s,i.mainMap.updateSize(),i.mainMap.getView().setCenter(l),i.mainMap.getView().setZoom(u)}catch(e){}}),i.mainMap.renderSync()},2e3)}),i.mainMap.updateSize()}),i}return n(t,e),t.prototype._afterCorridorLoad=function(){this._fitExtent(),p.default.init(this.mainMap,this._ssaId,this._snap),h.default.afterLoad(),f.default.afterLoad()},t.prototype._fitExtent=function(){for(var e=[],t=0,r=this._corridorArray;t<r.length;t++){var o=r[t];e.push(o.layer)}e.length>0&&d.fitToMap(e,this.mainMap)},t}(i.default);t.SsaMapView=C,v.SsaMapView=C,window.SsaMapView=C,t.default=C},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),i=r(18),a=r(0),s=r(2),l=r(1),u=a.default("layers"),c=function(e){function t(t,r){void 0===r&&(r={});var o=e.call(this,t,r)||this;return r=r,""==o.url.trim()&&(o._loaded=!0),o._style=void 0===r.style?void 0:r.style,o.visible?o._autoLoad=!0:o._autoLoad="boolean"==typeof r.autoLoad&&r.autoLoad,o._onDemand="boolean"==typeof r.onDemand&&r.onDemand,o._onDemandDelay="number"==typeof r.onDemandDelay?r.onDemandDelay:300,r.mapMoveObj?o._mapMove=r.mapMoveObj:o._mapMove=o._onDemand?i.default:void 0,o._mapMoveMakeGetParams="function"==typeof r.mapMoveMakeGetParams?r.mapMoveMakeGetParams:function(){return{}},o._onDemand&&(o._loaded=!0,o._mapMoveParams={},o._mapMove.checkInit(),o._mapMove.addVectorLayer(o)),o._source=new s.source.Vector,o._olLayer=new s.layer.Vector({source:o._source,visible:o.visible,style:o.style,minResolution:o._minResolution,maxResolution:o._maxResolution,renderOrder:r.renderOrder}),o.olLayer.setZIndex(o._zIndex),o._projectionMap=null,o._projection4326=new s.proj.Projection({code:"EPSG:4326"}),o}return o(t,e),t.prototype.addFeatures=function(e){console.log("Layer vector base addFeatures is a placeholder and does nothing")},t.prototype.mapMoveBefore=function(e,t){return!(void 0!==this.minZoom&&e<this.minZoom)&&(!(void 0!==this.maxZoom&&e>this.maxZoom)&&this.visible)},t.prototype.mapMoveMakeGetParams=function(e,t){this._mapMoveParams={},l.extend(this._mapMoveParams,this.params),l.extend(this._mapMoveParams,this._mapMoveMakeGetParams(this,e,t))},t.prototype.mapMoveCallback=function(e){this.source&&this._source.clear()},t.prototype.clear=function(){this._source&&this._source.clear()},Object.defineProperty(t.prototype,"onDemandDelay",{get:function(){return this._onDemandDelay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLoad",{get:function(){return this._autoLoad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){this._style=e,this.olLayer.setStyle(this._style)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapCrs",{get:function(){return null==this.mapProj?null:this.mapProj.getCode()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapProj",{get:function(){return null!=this._projectionMap?this._projectionMap:this._mapMove?(this._projectionMap=this._mapMove.map.getView().getProjection(),this._projectionMap):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapMove",{get:function(){return this._mapMove},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapMoveParams",{get:function(){return this._mapMoveParams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){e.prototype.setVisible.call(this,t),this._onDemand&&this.mapMove.triggerLyrLoad(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this.getSource()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return this.source.getFeatures()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"olLayer",{get:function(){return e.prototype.getOlLayer.call(this)},enumerable:!0,configurable:!0}),t.prototype.setZIndex=function(e){this.olLayer.setZIndex(e)},t}(n.LayerBase);t.LayerBaseVector=c,u.LayerBaseVector=c,t.default=c},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),i=r(30),a=r(3),s=r(0),l=r(2),u=r(1),c=s.default("layers"),d=function(e){function t(t,r){void 0===r&&(r={});var o=e.call(this,t,r)||this;return o._source=new l.source.TileArcGISRest({url:""==o.url?void 0:o.url,params:void 0===r.showLayers?void 0:{layers:"show:"+r.showLayers.join(",")}}),o._olLayer=new l.layer.Tile({source:o._source,visible:o.visible,opacity:o.opacity,minResolution:o._minResolution,maxResolution:o._maxResolution}),o._olLayer.setZIndex(o._zIndex),r.addPopup="boolean"==typeof r.addPopup&&r.addPopup,o._esriFormat=new l.format.EsriJSON,o._popupRequest=null,o.addLegendContent(),r.addPopup&&a.default.addMapServicePopup(o),o}return o(t,e),t.prototype.addLegendContent=function(t){var r=this,o=this.url;"/"!==o[o.length-1]&&(o+="/"),o+="legend?f=pjson&callback=?",u.get(o,{},function(t){var o=i.makeMapServiceLegend(t);e.prototype.addLegendContent.call(r,o)},"json")},t.prototype.getPopupInfo=function(e){if(this.visible){var t=this.url;"/"!=t[t.length-1]&&(t+="/"),t+="identify?callback=?";var r=this;null!=this._popupRequest&&this._popupRequest.abort(),this._popupRequest=u.get(t,e,function(e){for(var t=0,o=e.results;t<o.length;t++){var n=o[t],i='<table class="esri-popup-table">';for(var s in n.attributes)if(n.attributes.hasOwnProperty(s)){var l=n.attributes[s];if(null==l||"null"==l.toString().toLowerCase())continue;var u=s;u.length>14&&(u=u.slice(0,11)+"..."),i+="<tr><td>"+u+"</td><td>"+l+"</td></tr>"}i+="</table>",a.default.addMapServicePopupContent(r._esriFormat.readFeature(n),r,i,n.layerName)}},"json"),this._popupRequest.always(function(){r._popupRequest=null})}},Object.defineProperty(t.prototype,"source",{get:function(){return e.prototype.getSource.call(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"olLayer",{get:function(){return e.prototype.getOlLayer.call(this)},enumerable:!0,configurable:!0}),t}(n.LayerBase);t.LayerEsriMapServer=d,c.LayerEsriMapServer=d,t.default=d},function(e,t,r){"use strict";function o(e,t){return"rgba("+e[0]+","+e[1]+","+e[2]+","+t+")"}function n(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(e){var t=e.drawingInfo.renderer,r=null;switch(t.type){case"simple":switch(e.geometryType){case"esriGeometryPoint":r=new g(e,h);break;case"esriGeometryPolyline":r=new g(e,f);break;case"esriGeometryPolygon":r=new g(e,y);break;default:console.log(e),alert(e.geometryType+" not handled")}break;case"uniqueValue":switch(e.geometryType){case"esriGeometryPoint":r=new _(e,h);break;case"esriGeometryPolyline":r=new _(e,f);break;case"esriGeometryPolygon":r=new _(e,y);break;default:console.log(e),alert(e.geometryType+" not handled")}break;default:alert("not handled renderer type: "+t.type)}return null==r?{style:void 0,legend:""}:{style:r.olStyle,legend:r.legendHtml}}function a(e,t){void 0===t&&(t=!1),t="boolean"==typeof t&&t;var r=e.layerName,o=e.legend,i="";if(t||(i+='<span class="legend-layer-subitem">'+r+"</span>"),1==o.length)i='<img class="legend-layer-icon" height="17" src="data:image/png;base64,'+o[0].imageData+'">';else{t||(i+='<span class="legend-items-expander" title="Expand/Collapse">&#9660;</span>'),i+="<ul>";for(var a=0;a<o.length;a++)i+="<li>",i+='<span class="legend-layer-subitem">'+n(o[a].label)+"</span>",i+='<img class="legend-layer-icon" height="17" src="data:image/png;base64,'+o[a].imageData+'">',i+="</li>";i+="</ul>"}return t||(i='<span class="legend-layer-subitem">'+r+"</span>"+i),i}function s(e){var t="",r=e.layers;if(1==r.length)t+=a(r[0],!0);else{t+="<ul>";for(var o=0;o<r.length;o++)t+="<li>"+a(r[o])+"</li>";t+="</ul>"}return t}var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=r(0),c=r(2),d=u.default("olHelpers.esriToOlStyle");d.htmlEscape=n;var p=function(){function e(e,t){this.symbolObj=e,this.opacity=t,this.olStyle=void 0,this.legendHtml=""}return e}(),h=function(e){function t(t,r){var n=e.call(this,t,r)||this;switch(n.symbolObj.type){case"esriSMS":var i=o(n.symbolObj.color,n.opacity),a=o(n.symbolObj.outline.color,n.opacity),s=n.symbolObj.outline.width,l=n.symbolObj.size;n.olStyle=new c.style.Style({image:new c.style.Circle({radius:l,fill:new c.style.Fill({color:i}),stroke:new c.style.Stroke({color:a,width:s})})}),n.legendHtml='<span class="legend-layer-icon" style="color: '+i+'">&#9679;</span>';break;case"esriPMS":n.olStyle=new c.style.Style({image:new c.style.Icon({src:"data:image/png;base64,"+n.symbolObj.imageData})}),n.legendHtml='<img class="legend-layer-icon" height="17" src="data:image/png;base64,'+n.symbolObj.imageData+'">';break;default:console.log(n.symbolObj),alert("Point symbol does not handle symbol type: "+n.symbolObj.type)}return n}return l(t,e),t}(p),f=function(e){function t(t,r){var n=e.call(this,t,r)||this;switch(n.symbolObj.type){case"esriSLS":var i=o(n.symbolObj.color,n.opacity),a=n.symbolObj.width;n.olStyle=new c.style.Style({stroke:new c.style.Stroke({color:i,width:a})}),n.legendHtml='<span class="legend-layer-icon" ',n.legendHtml+='style="',n.legendHtml+="background-color: "+i+";",n.legendHtml+="width: 40px;",n.legendHtml+="height: 4px;",n.legendHtml+="position: relative;",n.legendHtml+="display: inline-block;",n.legendHtml+="top: -1px;",n.legendHtml+='"></span>';break;default:console.log(n.symbolObj),alert("Line symbol does not handle symbol type: "+n.symbolObj.type)}return n}return l(t,e),t}(p),y=function(e){function t(t,r){var n=e.call(this,t,r)||this;switch(n.symbolObj.type){case"esriSFS":var i=o(n.symbolObj.color,n.opacity),a=o(n.symbolObj.outline.color,n.opacity),s=n.symbolObj.outline.width;n.olStyle=new c.style.Style({stroke:new c.style.Stroke({color:a,width:s}),fill:new c.style.Fill({color:i})}),n.legendHtml='<span class="legend-layer-icon" ',n.legendHtml+='style="',n.legendHtml+="background-color: "+i+";",n.legendHtml+="border: solid "+a+" 1px;",n.legendHtml+="width: 40px;",n.legendHtml+="height: 9px;",n.legendHtml+="position: relative;",n.legendHtml+="display: inline-block;",n.legendHtml+="top: 2px;",n.legendHtml+='"></span>';break;default:console.log(n.symbolObj),alert("Polygon symbol does handle symbol type: "+n.symbolObj.type)}return n}return l(t,e),t}(p),m=function(){function e(e){this.opacity=(100-(e.drawingInfo.transparency||0))/100,this.renderer=e.drawingInfo.renderer,this.olStyle=void 0,this.legendHtml=""}return e}(),g=function(e){function t(t,r){var o=e.call(this,t)||this;o.symbol=o.renderer.symbol;var n=new r(o.symbol,o.opacity);return o.olStyle=n.olStyle,o.legendHtml=n.legendHtml,o}return l(t,e),t}(m),_=function(e){function t(t,r){var o=e.call(this,t)||this;if(o.uniqueValueInfos=o.renderer.uniqueValueInfos,o.propertyName=o.renderer.field1,o.defaultSymbol=o.renderer.defaultSymbol,o.defaultSymbol){var i=new r(o.defaultSymbol,o.opacity);o.defaultStyle=i.olStyle,o.defaultLabelHtml='<span class="legend-layer-subitem">'+n(o.renderer.defaultLabel)+"</span>"+i.legendHtml}else o.defaultStyle=void 0,o.defaultLabelHtml="other";o.valueArray=[],o.labelArray=[],o.legendArray=[],o.propertyStyleLookup={};for(var a=0,s=o.uniqueValueInfos;a<s.length;a++){var l=s[a];o.labelArray.push(l.label),o.valueArray.push(l.value);var u=new r(l.symbol,o.opacity);o.legendArray.push('<span class="legend-layer-subitem">'+n(l.label)+"</span>"+u.legendHtml),o.propertyStyleLookup[l.value]=u.olStyle}o.olStyle=function(e){var t=e.getProperties(),r=t[o.propertyName];return void 0!==o.propertyStyleLookup[r]?[o.propertyStyleLookup[r]]:[o.defaultStyle]},null!==o.defaultLabelHtml&&o.legendArray.push(o.defaultLabelHtml),o.legendHtml="<ul>";for(var c=0,d=o.legendArray;c<d.length;c++){var p=d[c];o.legendHtml+="<li>"+p+"</li>"}return o.legendHtml+="</ul>",o}return l(t,e),t}(m);t.makeFeatureServiceLegendAndSymbol=i,d.makeFeatureServiceLegendAndSymbol=i,t.makeMapServiceLegend=s,d.makeMapServiceLegend=s},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),i=r(20),a=r(0),s=r(4),l=r(1),u=a.default("olHelpers"),c=function(e){function t(){var t=e.call(this,"map move")||this;return t._arrLyrRequest=[],t._arrLyrTimeout=[],t._arrLayer=[],t._lookupLayer={},t._mapMoveCallbacks=[],t._mapMoveCallbacksLookup={},t._mapMoveCallbackDelays=[],t._mapMoveCallbackContext=[],t._mapMoveCallbackTimeout=[],t._mapExtent=void 0,t._zoomLevel=void 0,t}return o(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t),this.map.getView().on(["change:center","change:resolution"],function(e){r._updateMapExtent();for(var t=0;t<r._arrLayer.length;t++)r.triggerLyrLoad(r._arrLayer[t],t,e.type);for(var t=0;t<r._mapMoveCallbacks.length;t++)r.triggerMoveCallback(t,e.type)})},t.prototype._updateMapExtent=function(){var e=this.map.getView();this._zoomLevel=e.getZoom();var t=e.calculateExtent(this.map.getSize());this._mapExtent={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},Object.defineProperty(t.prototype,"mapExtent",{get:function(){return this._mapExtent||this._updateMapExtent(),this._mapExtent},enumerable:!0,configurable:!0}),t.prototype.triggerLyrLoad=function(e,t,r){if(i.undefinedOrNull(e)&&i.undefinedOrNull(t))throw"need to define lyr or index";i.definedAndNotNull(e)&&i.undefinedOrNull(t)?t=this._arrLayer.indexOf(e):i.undefinedOrNull(e)&&i.definedAndNotNull(t)&&(e=this._arrLayer[t]),null!=this._arrLyrTimeout[t]&&(clearTimeout(this._arrLyrTimeout[t]),this._arrLyrTimeout[t]=null),null!=this._arrLyrRequest[t]&&4!=this._arrLyrRequest[t]&&(this._arrLyrRequest[t].abort(),this._arrLyrRequest[t]=null);var o=function(){};if(e.mapMoveBefore(this._zoomLevel,r)){e.mapMoveMakeGetParams(this._mapExtent,this._zoomLevel);var n=this;o=function(){function r(e,t){var r=this;this._arrLyrRequest[t]=l.get(e.url,e.mapMoveParams,function(t){e.mapMoveCallback(t),e.loadCallback()},"json").fail(function(t){"abort"!=t.statusText&&(console.log("failed"),console.log(e.url),console.log(e.mapMoveParams))}).always(function(){r._arrLyrTimeout[t]=null,r._arrLyrRequest[t]=null})}r.call(n,e,t)}}else e.clear();this._arrLyrTimeout[t]=setTimeout(o,e.onDemandDelay)},t.prototype.triggerMoveCallback=function(e,t,r){if(void 0===e&&void 0===r)throw"either the function index or the id must be defined";if("number"!=typeof e&&(e=this._mapMoveCallbacks.indexOf(this._mapMoveCallbacksLookup[r])),e<0)return void console.log("function not found");null!=this._mapMoveCallbackTimeout[e]&&(clearTimeout(this._mapMoveCallbackTimeout[e]),this._mapMoveCallbackTimeout[e]=null);var o=this._mapMoveCallbackContext[e],n=this._mapMoveCallbacks[e],i=this,a=function(){null!==o?n.call(o,i._mapExtent,i._zoomLevel,t):n(i._mapExtent,i._zoomLevel,t)};this._mapMoveCallbackTimeout[e]=setTimeout(a,this._mapMoveCallbackDelays[e])},t.prototype.addVectorLayer=function(e,t){if(void 0===t&&(t=!0),this._arrLayer.indexOf(e)>-1)return void console.log("already added "+e.name+" to map move");this._checkInit(),this._arrLyrRequest.push(null),this._arrLyrTimeout.push(null),this._arrLayer.push(e),this._lookupLayer[e.id]=e,(t="boolean"!=typeof t||t)&&(void 0===this._mapExtent&&this._updateMapExtent(),this.triggerLyrLoad(e,this._arrLayer.length-1))},t.prototype.addCallback=function(e,t,r,o,n){if(this._mapMoveCallbacks.indexOf(e)>-1)return void console.log("this function already added to map move");this._checkInit(),n||(n=s.default()),this._mapMoveCallbacks.push(e),this._mapMoveCallbacksLookup[n]=n,this._mapMoveCallbackDelays.push("number"==typeof r?r:50),this._mapMoveCallbackContext.push(i.definedAndNotNull(t)?t:null),this._mapMoveCallbackTimeout.push(null),(o="boolean"!=typeof o||o)&&(void 0===this._mapExtent&&this._updateMapExtent(),this.triggerMoveCallback(this._mapMoveCallbacks.length-1))},t}(n.default);t.MapMoveCls=c,u.MapMoveCls=c,t.default=c},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),i=r(0),a=r(2),s=r(1),l=i.default("olHelpers"),u=function(){function e(e,t,r,o,n){this.feature=e,this.layer=t,this.layerIndex=r,this.selectionLayer=o,this.popupContent="",this.esriLayerName="string"==typeof n?n:void 0}return Object.defineProperty(e.prototype,"layerName",{get:function(){return"string"==typeof this.esriLayerName?this.esriLayerName:this.layer.name},enumerable:!0,configurable:!0}),e}();t.FeatureLayerProperties=u;var c=function(e){function t(){var t=e.call(this,"map popup")||this;return t._arrPopupLayerIds=[],t._arrPopupLayerNames=[],t._arrPopupLayers=[],t._arrPopupOlLayers=[],t._arrPopupContentFunction=[],t._$popupContainer=void 0,t._$popupContent=void 0,t._$popupCloser=void 0,t._popupOverlay=void 0,t._selectionLayers=[],t._selectionLayerLookup={},t._mapClickFunctions=[],t._popupChangedFunctions=[],t._esriMapServiceLayers=[],t._popupOpen=!1,t._popupCoordinate=null,t._passThroughLayerFeatureArray=[],t._currentPopupIndex=-1,t._popupContentLength=0,t}return o(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t);var o,n=this.map.getTarget();o=s("string"==typeof n?"#"+n:n),o.append('<div class="ol-popup"><span class="ol-popup-closer">X</span><div class="popup-content"></div></div>'),this._$popupContainer=o.find(".ol-popup"),this._$popupContent=o.find(".popup-content"),this._$popupCloser=o.find(".ol-popup-closer");var i=function(e){return a.easing.inAndOut(e)};return this._popupOverlay=new a.Overlay({element:this._$popupContainer[0],autoPan:!0,autoPanAnimation:{duration:250,source:t.getView().getCenter(),easing:i}}),this._map.addOverlay(this._popupOverlay),this._$popupCloser.click(function(e){r.closePopup()}),this._map.on("singleclick",function(e){if(r.closePopup(),r._popupCoordinate=e.coordinate,r._esriMapServiceLayers.length>0)for(var t={geometry:e.coordinate.join(","),geometryType:"esriGeometryPoint",layers:"all",sr:r._map.getView().getProjection().getCode().split(":")[1],mapExtent:r._map.getView().calculateExtent(r._map.getSize()).join(","),imageDisplay:r._map.getSize().join(",")+",96",returnGeometry:!0,tolerance:15,f:"pjson"},o=0,n=r._esriMapServiceLayers;o<n.length;o++){var i=n[o];i.getPopupInfo(t)}var a=r._featuresAtPixel(e.pixel);r._passThroughLayerFeatureArray=[],r._currentPopupIndex=-1;for(var s=0;s<a.length;s++){var l=a[s],u=l.feature.getProperties(),c=r._arrPopupContentFunction[l.layerIndex](u,r._$popupContent);c===!1||("string"==typeof c?(l.popupContent=c,r._passThroughLayerFeatureArray.push(l)):l.selectionLayer.getSource().addFeature(l.feature))}r._popupContentLength=r._passThroughLayerFeatureArray.length,r._currentPopupIndex=-1;var d='<div class="ol-popup-nav">';d+='<span class="previous-popup ol-popup-nav-arrow">&#9664;</span>',d+='<span class="next-popup ol-popup-nav-arrow">&#9654;</span>',d+='<span class="current-popup-item-number" style="font-weight: bold;"></span>',d+="<span>&nbsp;of&nbsp;</span>",d+='<span class="popup-content-length" style="font-weight: bold;">'+r._popupContentLength+"</span>",d+="<span>&nbsp;&nbsp;-&nbsp;&nbsp;</span>",d+='<span class="current-popup-layer-name"></span>',d+="</div>",d+='<div class="ol-popup-inner">',d+="</div>",r._$popupContent.html(d),r._$popupContent.find(".previous-popup").click(function(){1!=r._popupContentLength&&(0==r._currentPopupIndex?r._currentPopupIndex=r._popupContentLength-1:r._currentPopupIndex--,r._triggerFeatSelect())});var p=r._$popupContent.find(".next-popup");p.click(function(){1==r._popupContentLength&&r._currentPopupIndex>-1||(r._currentPopupIndex==r._popupContentLength-1?r._currentPopupIndex=0:r._currentPopupIndex++,r._triggerFeatSelect())}),r._popupContentLength>0&&(p.trigger("click"),r._popupOverlay.setPosition(r._popupCoordinate),r._$popupContent.scrollTop(0),r._popupOpen=!0)}),this._map.on("pointermove",function(e){if(!e.dragging){var t=r.map.getEventPixel(e.originalEvent),o=r.map.hasFeatureAtPixel(t,function(e){for(var t=0,o=r._arrPopupOlLayers;t<o.length;t++){if(e==o[t])return!0}return!1});r.map.getTargetElement().style.cursor=o?"pointer":""}}),!0},t.prototype._triggerFeatSelect=function(){var e=this._$popupContent.find(".current-popup-item-number"),t=this._$popupContent.find(".ol-popup-inner"),r=this._$popupContent.find(".current-popup-layer-name");this.clearSelection();var o=this._passThroughLayerFeatureArray[this._currentPopupIndex];e.html((this._currentPopupIndex+1).toFixed()),r.html(o.layerName),t.html(o.popupContent),o.selectionLayer.getSource().addFeature(o.feature);for(var n=0,i=this._popupChangedFunctions;n<i.length;n++){(0,i[n])(this._$popupContent)}},t.prototype.addMapServicePopupContent=function(e,t,r,o){var n=new u(e,t,this._popupContentLength,this._selectionLayerLookup[t.id],o);n.popupContent=r,this._passThroughLayerFeatureArray.push(n),this._popupContentLength++,s(".popup-content-length").html(this._popupContentLength.toFixed()),this._popupOpen||(this._$popupContent.find(".next-popup").trigger("click"),this._popupOverlay.setPosition(this._popupCoordinate),this._$popupContent.scrollTop(0),this._popupOpen=!0)},t.prototype._featuresAtPixel=function(e){var t=this,r=[];return this.map.forEachFeatureAtPixel(e,function(e,o){var n=t._arrPopupOlLayers.indexOf(o);n>-1&&r.push(new u(e,t._arrPopupLayers[n],n,t._selectionLayers[n]))}),r},t.prototype.closePopup=function(){return this._checkInit(),this._popupOpen=!1,this._popupOverlay.setPosition(void 0),this._$popupCloser[0].blur(),this.clearSelection(),this._$popupContent.html(""),!1},t.prototype.addPopupChangedFunction=function(e){this._popupChangedFunctions.push(e)},t.prototype._addPopupLayer=function(e,t){this._checkInit(),t=t||{},t.color=t.color||"rgba(255,170,0,0.5)",t.width=t.width||10;var r;r=t.olStyle?t.olStyle:new a.style.Style({stroke:new a.style.Stroke({color:t.color,width:t.width}),image:new a.style.Circle({radius:7,fill:new a.style.Fill({color:t.color}),stroke:new a.style.Stroke({color:t.color,width:1})}),fill:new a.style.Fill({color:t.color})});var o=new a.layer.Vector({source:new a.source.Vector,style:r});return o.setZIndex(100),this._selectionLayers.push(o),this._selectionLayerLookup[e.id]=o,this.map.addLayer(o),o},t.prototype.addVectorPopup=function(e,t,r){var o=this._addPopupLayer(e,r);return this._arrPopupLayerIds.push(e.id),this._arrPopupLayerNames.push(e.name),this._arrPopupLayers.push(e),this._arrPopupOlLayers.push(e.olLayer),this._arrPopupContentFunction.push(t),o},t.prototype.removeVectorPopup=function(e){var t=this._arrPopupLayerIds.indexOf(e.id);t>-1&&(this._arrPopupLayerIds.splice(t,1),this._arrPopupLayerNames.splice(t,1),this._arrPopupLayers.splice(t,1),this._arrPopupOlLayers.splice(t,1),this._arrPopupContentFunction.splice(t,1),this._selectionLayers.splice(t,1),delete this._selectionLayerLookup[e.id])},t.prototype.addMapServicePopup=function(e,t){var r=this._addPopupLayer(e,t);return this._esriMapServiceLayers.push(e),r},t.prototype.clearSelection=function(){this._checkInit();for(var e=0;e<this._selectionLayers.length;e++)this._selectionLayers[e].getSource().clear();for(var t=0,r=this._mapClickFunctions;t<r.length;t++){(0,r[t])()}},t.prototype.addMapClickFunction=function(e){this._mapClickFunctions.push(e)},t}(n.default);t.MapPopupCls=c,l.MapPopupCls=c,t.default=c},function(e,t,r){"use strict";function o(e){void 0===e&&(e={}),e.divId=e.divId||"map",e.center=e.center||{x:-10018378,y:5574910},e.zoom="number"==typeof e.zoom?e.zoom:7,e.baseSwitcher="boolean"!=typeof e.baseSwitcher||e.baseSwitcher,e.fullScreen="boolean"==typeof e.fullScreen&&e.fullScreen,a("#"+e.divId).css("position","relative");var t=new i.layer.Tile({source:new i.source.OSM});if(e.baseSwitcher,e.zoom<0||e.zoom>28)throw"zoom out of range";if(e.center.x>=-180&&e.center.x<=180&&e.center.y>=-90&&e.center.y<=90){var r=new i.geom.Point([e.center.x,e.center.y]);new i.proj.Projection({code:"EPSG:4326"}),r.transform(new i.proj.Projection({code:"EPSG:4326"}),new i.proj.Projection({code:"EPSG:3857"}));var o=r.getCoordinates();e.center.x=o[0],e.center.y=o[1]}var n=i.control.defaults({attributionOptions:{collapsible:!1}}),s=new i.View({center:[e.center.x,e.center.y],zoom:e.zoom,minZoom:e.minZoom,maxZoom:e.maxZoom}),l=new i.Map({layers:[t],target:e.divId,controls:n,view:s});return e.fullScreen&&l.addControl(new i.control.FullScreen({})),l}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2),a=r(1),s=n.default("olHelpers");t.quickMapBase=o,s.quickMapBase=o,t.default=o},function(e,t,r){"use strict";function o(e){return"number"==typeof e?e%1==0&&e>=0&&e<=28?s[e]:void console.log("invalid zoom level provided: "+e):void 0}function n(e){for(var t=0;t<s.length;t++)if(e>=s[t])return t;return 0}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=i.default("olHelpers.zoomResolutionConvert"),s=[156543.03392804097,78271.51696402048,39135.75848201024,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.8740565703525,76.43702828517625,38.21851414258813,19.109257071294063,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,.5971642834779395,.29858214173896974,.14929107086948487,.07464553543474244,.03732276771737122,.01866138385868561,.009330691929342804,.004665345964671402,.002332672982335701,.0011663364911678506,.0005831682455839253];t.zoomToResolution=o,a.zoomToResolution=o,t.resolutionToZoom=n,a.resolutionToZoom=n},function(e,t,r){"use strict";function o(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return isNaN(e)?"00":t[(e-e%16)/16]+t[e%16]}function n(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return("#"+o(t[1])+o(t[2])+o(t[3])).toUpperCase()}function i(e,t){e="#"==e.charAt(0)?e.substring(1,7):e;var r=parseInt(e.substring(0,2),16).toString()||"0",o=parseInt(e.substring(2,4),16).toString()||"0",n=parseInt(e.substring(4,6),16).toString()||"0";return t?"rgba("+r+","+o+","+n+","+t+")":"rgba("+r+","+o+","+n+")"}function a(e,t){var r=e.split(",");return r[0]=r[0].replace("rgb","rgba"),r[2]=r[2].replace(")",""),r.push(" "+t.toFixed(1)+")"),r.join(",")}function s(e,t,r){return"boolean"!=typeof r&&(r=!1),function(o){var n,i,a,s;if(c.undefinedOrNull(o))return"rgb(100,100,100)";var l=(o-e)/(t-e);return 1==r&&(l=1-l),l>=1?(n=255,i=0,a=0):l<=0?(n=0,i=0,a=255):l<.25?(n=0,i=Math.floor(255*l/.25),a=255):l<.5?(s=(l-.25)/.25,n=0,i=255,a=255-Math.floor(255*s)):l<.75?(s=(l-.5)/.25,n=Math.floor(255*s),i=255,a=0):(s=(l-.75)/.25,n=255,i=255-Math.floor(255*s),a=0),n=n.toFixed(),i=i.toFixed(),a=a.toFixed(),"rgb("+n+","+i+","+a+")"}}function l(e,t,r){var o=s(-2.5,2.5,r);return function(r){var n;return n=null==r?null:(r-e)/t,o(n)}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(0),c=r(20),d=u.default("util.colors");t.rgb2hex=n,d.rgb2hex=n,t.hexAlphaToRgbOrRgba=i,d.hexAlphaToRgbOrRgba=i,t.rgbToRgba=a,d.rgbToRgba=a,t.makeBlueGreenRedGradient=s,d.makeBlueGreenRedGradient=s,t.makeBlueGreenRedGradientZScore=l,d.makeBlueGreenRedGradientZScore=l},function(e,t,r){"use strict";function o(e){void 0===e&&(e=""),e="string"==typeof e?e:"";var t="<table>";return t+="<tr>",t+="<th></th>",t+="<th>Corridors</th>",t+="<th></th>",t+="</tr>",t+=e,t+="</table>"}function n(e,t){return e.substring(0,7)+" - "+t.substring(0,7)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(3),s=r(13),l=r(4),u=r(24),c=r(14),d=r(1),p=r(10),h=i.default("ssa"),f=function(){function e(e,t,r,n,i){var a=this;this._dataClass=i||"corridor-data",this._afterChange=n;var s=d("."+r+", #"+r);if(0==s.length)throw"data container not found";this.$corridorDataContainer=d(s[0]),this.$corridorDataContainer.addClass("corridor-data-container"),this._map=t;var u=l.default();e.append('<div id="'+u+'"></div>'),this.$containerEl=d("#"+u).addClass("corridor-collection-container");var c='<div class="corridor-collection">';c+=o(),c+="</div>",this.$containerEl.append(c),this.$innerContainer=this.$containerEl.find(".corridor-collection"),this._visible=!0,this._inCreateModifyOperation=!1,this._showPopups=!0,this._corridorArray=[],this._coridorLookup={},this._popupStyle=function(e){return!!a.showPopups&&p.mmPopupContent(e)}}return e.prototype.addCorridorCreate=function(e,t){void 0===t&&(t=!0),this._corridorArray.push(e),this._coridorLookup[e.clientId]=e,this._map.addLayer(e.olLayer),this._map.addLayer(e.nodeLayer.olLayer),e.layer.name=n(e.rpFrom,e.rpTo),a.default.addVectorPopup(e.layer,this._popupStyle),t&&this.refreshHtmlCreate()},e.prototype.removeCorridor=function(e){if(confirm("Confirm Delete Corridor?")){"string"==typeof e&&(e=this._coridorLookup[e]);var t=this._corridorArray.indexOf(e);a.default.removeVectorPopup(e.layer),this._map.removeLayer(e.olLayer),this._map.removeLayer(e.nodeLayer.olLayer),this._corridorArray.splice(t,1),delete this._coridorLookup[e.clientId],this._map.getView().setZoom(this._map.getView().getZoom()-1),this._map.getView().setZoom(this._map.getView().getZoom()+1),this.refreshHtmlCreate()}},e.prototype.refreshHtmlCreate=function(){this.$innerContainer.html("");for(var e="",t=0,r=this._corridorArray;t<r.length;t++){e+=r[t].tableHtmlCreate}this.$innerContainer.append(o(e)),this.$corridorDataContainer.html("");for(var n=0;n<this._corridorArray.length;n++){var i=this._corridorArray[n];this.$corridorDataContainer.append(i.getDataHtml(n))}this._afterChange()},Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){e!=this.visible&&(this._visible=e,this.visible?this.$containerEl.show():this.$containerEl.hide())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){for(var e=[],t=0,r=this._corridorArray;t<r.length;t++){var o=r[t];e.push(o.layer)}return s.calculateExtent(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inCreateModifyOperation",{get:function(){return this._inCreateModifyOperation},set:function(e){this._inCreateModifyOperation=e,this.inCreateModifyOperation?this.$innerContainer.addClass("corridor-collection-create-modify"):this.$innerContainer.removeClass("corridor-collection-create-modify")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showPopups",{get:function(){return this._showPopups},set:function(e){this._showPopups=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"corridorCount",{get:function(){return this._corridorArray.length},enumerable:!0,configurable:!0}),e.prototype.getCorridorById=function(e){return this._coridorLookup[e]},e.prototype.loadExistingCorridors=function(){for(var e=this,t=0,r=document.getElementsByClassName(this._dataClass),o=0;o<r.length;o++){var n=r[o],i=new u.default(n),a=new c.default(i.startPdp,i.endPdp,i.startRp,i.endRp,i.startCounty,i.endCounty,i.hgwy,i.routeId,{loadedCallback:function(){if(t++,e.corridorCount==t){var r=e.fullExtent;r&&e._map.getView().fit(r,e._map.getSize()),e.refreshHtmlCreate()}}});a.setDbValues(i),0==o&&(d("#primaryCounty").val(a.countyStart),d("#primaryRdwyRteId").val(a.routeId)),this.addCorridorCreate(a,!1)}},e}();t.CorridorCollection=f,h.CorridorCollection=f,t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(45),n=r(46),i=r(44),a=r(14),s=r(0),l=r(7),u=r(3),c=r(4),d=r(29),p=r(1);r(1);var h=s.default("ssa"),f=function(){function e(e,t){this._map=t,e.append('<div><input type="button" value="Add Corridor" class="btn btn-default picker-create-corridor"><input type="button" value="Zoom to Extent" class="btn btn-default picker-zoom-extent"></div>'),this.$createCorridorButton=e.find(".picker-create-corridor"),this.$zoomExtentButton=e.find(".picker-zoom-extent");var r=c.default();e.append('<div id="'+r+'"></div>'),this.$containerEl=p("#"+r).addClass("picker-collection-container"),this.$containerEl.append('<div class="picker-collection"><span class="corridor-picker-help" title="Show Help"></span></div>'),this.$containerEl.append('<input type="button" value="Preview" class="btn btn-default picker-preview">'),this.$containerEl.append('<input type="button" value="Add" class="btn btn-default picker-add" disabled="disabled">'),this.$containerEl.append('<input type="button" value="Modify" class="btn btn-default picker-modify" disabled="disabled" style="display: none;">'),this.$containerEl.append('<input type="button" value="Cancel" class="btn btn-default picker-cancel">'),this.$innerContainer=this.$containerEl.find(".picker-collection"),this._dummyCorridor=new a.default(1,1,"","",1,1,"h",-1,{cancelLoad:!0,color:l.corridorPreviewColor}),this._dummyCorridor.layer.zIndex=10,this._map.addLayer(this._dummyCorridor.olLayer),this._addModifyEnabled=!1,this._modifyCorridor=void 0,this.$btnPickerPreview=this.$containerEl.find(".picker-preview"),this.$btnPickerAdd=this.$containerEl.find(".picker-add"),this.$btnPickerModify=this.$containerEl.find(".picker-modify"),this.$btnPickerCancel=this.$containerEl.find(".picker-cancel"),this.countyStartSelect=new o.default(this.$innerContainer,"Start County"),this.countyEndSelect=new o.default(this.$innerContainer,"End County"),this.highwaySelect=new n.default(this.$innerContainer),this._metamanagerSegmentsLayer=new d.default("http://transportal.cee.wisc.edu/applications/arcgis2/rest/services/MetaManager/MM_All_Segments/MapServer",{minZoom:7,visible:!1,name:"Metamanager Segments",opacity:.4}),this._map.addLayer(this._metamanagerSegmentsLayer.olLayer),this.segmentPickerFrom=new i.default(this,!0),this.segmentPickerTo=new i.default(this,!1),this._map.addLayer(this.segmentPickerFrom.segmentLayer.olLayer),this._map.addLayer(this.segmentPickerTo.segmentLayer.olLayer),this._map.addLayer(this.segmentPickerFrom.selectionLayer.olLayer),this._map.addLayer(this.segmentPickerTo.selectionLayer.olLayer),this.corridorCollection=void 0,this._addHandlers(),this._helpDialogInit()}return e.prototype._addHandlers=function(){var e=this;this.$createCorridorButton.click(function(){e.startPicker(),e.$createCorridorButton.prop("disabled",!0)}),this.$zoomExtentButton.click(function(){var t=e.corridorCollection.fullExtent;t&&e._map.getView().fit(t,e._map.getSize())}),this.$btnPickerCancel.click(function(){e.stopPicker()}),this.$btnPickerPreview.click(function(){e.previewCorridor()}),this.$btnPickerAdd.click(function(){e.addCorridor()}),this.$btnPickerModify.click(function(){e.modifyCorridor()}),this.countyStartSelect.addChangeListener(function(t){e.highwaySelect.setStartEndCounty(t,e.countyEndSelect.selectedValue),e.addModifyButtonEnabled=!1,e.segmentPickerTo.segmentLayer.visible=!e.startEndCountySame}),this.countyEndSelect.addChangeListener(function(t){e.highwaySelect.setStartEndCounty(e.countyStartSelect.selectedValue,t),e.addModifyButtonEnabled=!1,e.segmentPickerTo.segmentLayer.visible=!e.startEndCountySame}),this.highwaySelect.addChangeListener(function(t){e.segmentPickerFrom.setCountyAndRoute(e.countyStartSelect.selectedValue,t),e.segmentPickerTo.setCountyAndRoute(e.countyEndSelect.selectedValue,t),e.addModifyButtonEnabled=!1}),this.segmentPickerFrom.addChangeListener(function(){e.addModifyButtonEnabled=!1}),this.segmentPickerTo.addChangeListener(function(){e.addModifyButtonEnabled=!1})},e.prototype._helpDialogInit=function(){var e=this,t="Corridors are defined by selecting in sequence the start county, highway, and end county ";t+="The reference points are then populated and can be selected either by using the combo box or ",t+="by clicking a segment in the map and clicking select in the resulting popup ",t+="Corridors are defined visually in the pickers as the start segment (green) and end segment (red) ",t+="inclusive of the corridor extents",p("body").append('<div class="corridor-picker-help-dialog" title="Corridor Selection Help"><p style="text-align: justify">'+t+"</p></div>"),this.helpDialog=p(".corridor-picker-help-dialog"),this.helpDialog.dialog({modal:!0,autoOpen:!1,height:450,width:650,buttons:[{text:"OK",click:function(){p(this).dialog("close")}}]}),this.$containerEl.find(".corridor-picker-help").click(function(){e.helpDialog.dialog("open")})},e.prototype.previewCorridor=function(){var e=this;if(!this.segmentPickerFrom.selectedPdpId||!this.segmentPickerTo.selectedPdpId)return void alert("Select From and To Reference Points");this._map.removeLayer(this._dummyCorridor.layer.olLayer),this._map.removeLayer(this._dummyCorridor.nodeLayer.olLayer),this._dummyCorridor=new a.default(this.segmentPickerFrom.selectedPdpId,this.segmentPickerTo.selectedPdpId,this.segmentPickerFrom.selectedText,this.segmentPickerTo.selectedText,this.countyStartSelect.selectedValue,this.countyEndSelect.selectedValue,this.highwaySelect.selectedText,this.highwaySelect.selectedValue,{cancelLoad:!0,color:l.corridorPreviewColor}),this._dummyCorridor.layer.zIndex=10,this._map.addLayer(this._dummyCorridor.layer.olLayer),this._map.addLayer(this._dummyCorridor.nodeLayer.olLayer),this._dummyCorridor.load(function(t){e._map.getView().fit(t.extent,e._map.getSize()),e.addModifyButtonEnabled=!0})},e.prototype.addCorridor=function(){var e=this._dummyCorridor.clone();this.corridorCollection.addCorridorCreate(e),this.segmentPickerTo.segmentLayer.visible=!this.startEndCountySame,this.stopPicker()},e.prototype.modifyCorridor=function(){this._modifyCorridor.updateCorridor(this._dummyCorridor),this.corridorCollection.refreshHtmlCreate(),this.stopPicker()},e.prototype.startPicker=function(e){if(this.corridorCollection.inCreateModifyOperation=!0,this.$containerEl.show(),this.segmentPickerFrom.layersVisible=!0,this.segmentPickerTo.layersVisible=!0,this._metamanagerSegmentsLayer.visible=!0,this.corridorCollection.showPopups=!1,e)this.$btnPickerAdd.hide(),this.$btnPickerModify.show(),this.countyStartSelect.box.val(e.countyStart),this.countyEndSelect.box.val(e.countyEnd),this.highwaySelect.setStartEndCounty(e.countyStart,e.countyEnd,e.routeId),this.segmentPickerFrom.setCountyAndRoute(e.countyStart,e.routeId,e.pdpFrom),this.segmentPickerTo.setCountyAndRoute(e.countyEnd,e.routeId,e.pdpTo),this._modifyCorridor=e,this._dummyCorridor.updateCorridor(e),this._map.getView().fit(this._dummyCorridor.extent,this._map.getSize());else{var t=p("#primaryCounty"),r=p("#primaryRdwyRteId"),o=void 0,n=void 0;t.length>0&&(o=t.val().length>0?parseInt(t.val()):void 0),r.length>0&&(n=r.val().length>0?parseInt(r.val()):void 0),o&&(this.countyStartSelect.box.val(o),this.countyEndSelect.box.val(o),this.highwaySelect.setStartEndCounty(o,o,n,!0)),this.$btnPickerAdd.show(),this.$btnPickerModify.hide()}},e.prototype.stopPicker=function(){this.corridorCollection.showPopups=!0,this.$btnPickerAdd.show(),this.$btnPickerModify.hide(),this.$btnPickerModify.prop("disabled",!0),this.$containerEl.hide(),this.$createCorridorButton.prop("disabled",!1),this.corridorCollection.visible=!0,this._dummyCorridor.layer.clear(),this._modifyCorridor=void 0,this._dummyCorridor.nodeLayer.olLayer.getSource().clear(),this.addModifyButtonEnabled=!1,this.corridorCollection.inCreateModifyOperation=!1,p(".corridor-tr-selected").removeClass("corridor-tr-selected"),this.segmentPickerFrom.layersVisible=!1,this.segmentPickerTo.layersVisible=!1,this._metamanagerSegmentsLayer.visible=!1,u.default.closePopup()},Object.defineProperty(e.prototype,"addModifyButtonEnabled",{get:function(){return this._addModifyEnabled},set:function(e){this._addModifyEnabled=e,this.$btnPickerAdd.prop("disabled",!this.addModifyButtonEnabled),this.$btnPickerModify.prop("disabled",!this.addModifyButtonEnabled)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startEndCountySame",{get:function(){var e=this.countyStartSelect.selectedValue==this.countyEndSelect.selectedValue;return this.segmentPickerFrom.segmentLayer.name=e?"Start/End Segments":"Start Segment",e},enumerable:!0,configurable:!0}),e}();h.PickerCollection=f,t.default=f},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(42),i=r(3),a=r(9),s=r(23),l=r(2),u=r(21),c=function(e){for(var t=e.getProperties(),r=!1,o=0,i=n.default.allValues;o<i.length;o++){var s=i[o];if(t[s]&&n.default.valIsOn(s)){r=!0;break}}var u=function(){return new l.style.Text({text:t.ccId,scale:1.5,stroke:new l.style.Stroke({color:"black",width:2}),fill:new l.style.Fill({color:a.controllingCriteriaColor})})};return r?[new l.style.Style({stroke:new l.style.Stroke({color:a.controllingCriteriaColor,width:6}),text:u()})]:null},d=function(e){function t(){return e.call(this,"Geometric Deficiencies",c,201,a.ccListId)||this}return o(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t),n.default.addChangeCallback(function(){r.deficiencyLayer.refresh()}),i.default.addVectorPopup(this.deficiencyLayer,function(e){var t="";t+="<ul>";for(var r=0,o=u.keyValPairs(a.controllingCriteriaProps);r<o.length;r++){var n=o[r];if(e[n.key]){t+="<li>",t+=n.value;var i=e[n.key].split("::");t+="<ul>";for(var s=0,l=i;s<l.length;s++){var c=l[s];isNaN(parseInt(c))&&0!=c.trim().length&&(t+="<li>"+c+"</li>")}t+="</ul>",t+="</li>"}}return t+="</ul>"})},t.prototype.addCorridor=function(e){for(var t=e.layer.source.getFeatures(),r=0,o=t;r<o.length;r++){for(var n=o[r],i=n.getProperties(),s=[],l=0,c=u.keyValPairs(a.controllingCriteriaProps);l<c.length;l++){var d=c[l];i[d.key]&&s.push(d.value)}if(s.length>0){this.deficiencyLayer.source.addFeature(n),n.setProperties({ccId:""+i.pdpId});var p="<b>"+i.pdpId+"</b>:&nbsp;";p+=s.join(", "),this.$summaryList.append("<li "+a.pdpDataAttr+'="'+i.pdpId+'">'+p+"</li>")}}},t}(s.default);d.propNames=["ccDesignSpeed","ccLaneWidth","ccShoulderWidth","ccHorizontalCurve","ccSuperelevation","ccMaximumGrade","ccStoppingSight","ccCrossSlope","ccVerticalClearance","ccDesignLoading"],t.ControllingCriteria=d,t.default=new d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),n=r(21),i=r(8),a=r(25),s=r(6),l=r(3),u=r(7),c=r(10),d=r(10),p=r(2),h=r(1),f=function(){function e(){this._crashHtmlLookup={},this._crashArrayLookup={},this.pointCrashes=new i.default("",{name:"Crash Points",zIndex:204,minZoom:10,renderOrder:function(e,t){var r=["P","C","B","A","K"],o=e.getProperties().injSvr,n=t.getProperties().injSvr,i=r.indexOf(o),a=r.indexOf(n);return i==a?0:i>a?1:-1}}),this.pointCrashes.style=u.crashPointStyle}return e.prototype.init=function(e,t,r){var n=this;l.default.addVectorPopup(this.pointCrashes,c.crashPointPopup),a.default.addChangeCallback(function(){n.pointCrashes.refresh()}),o.default.getCrashes(t,r,function(e){n._processCrashData(e)}),e.addLayer(this.pointCrashes.olLayer)},e.prototype._processCrashData=function(e){for(var t=0,r=n.keyValPairs(e);t<r.length;t++){for(var o=r[t],i=o.value,a=[],l=[],u=0,c=i;u<c.length;u++){var f=c[u];l.indexOf(f.doctnmbr)>-1||(l.push(f.doctnmbr),a.push(f))}this._crashHtmlLookup[o.key]=d.crashInfoHelper(a),this._crashArrayLookup[o.key]=a;for(var y=0,m=a;y<m.length;y++){var f=m[y];if(f.lon&&f.lat){var g=new p.geom.Point([f.lon,f.lat]);g.transform(s.proj4326,s.proj3857);var _=new p.Feature(g);f.injSvr=f.injSvr||"O",_.setProperties(f),this.pointCrashes.source.addFeature(_)}}}var v=h(".crashes-loaded-msg");v?(v.fadeIn(),setTimeout(function(){v.fadeOut()},4e3)):console.log("get crashes message element not found")},e.prototype.getCrashSummary=function(e){return this._crashHtmlLookup[e.toString()]||""},e}();t.CrashData=f,t.default=new f},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(43),i=r(3),a=r(9),s=r(23),l=r(2),u=function(e){var t=e.getProperties(),r=function(){return new l.style.Text({text:t.mmId,scale:1.5,stroke:new l.style.Stroke({color:"black",width:2}),fill:new l.style.Fill({color:a.mmFlagColor})})};return t.rateFlag>=1&&n.default.mmRateFlagOn||t.kabCrshFlag>=1&&n.default.mmKabFlagOn?[new l.style.Style({stroke:new l.style.Stroke({color:a.mmFlagColor,width:6}),text:r()})]:null},c=function(e){function t(){return e.call(this,"Safety Flags",u,200,a.mmFlagListId)||this}return o(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t),n.default.addChangeCallback(function(){r.deficiencyLayer.refresh()}),i.default.addVectorPopup(this.deficiencyLayer,function(e){var t=[];return null!=e.rateFlag&&t.push("Rate Flag: "+e.rateFlag.toFixed(4)),null!=e.kabCrshFlag&&t.push("KAB Flag: "+e.kabCrshFlag.toFixed(4)),"MM ID: "+e.mmId+"<br/>"+t.join("<br>")})},t.prototype.addCorridor=function(e){for(var t=e.layer.source.getFeatures(),r=0,o=t;r<o.length;r++){var n=o[r],i=n.getProperties(),s=i.rateFlag>=1,l=i.kabCrshFlag>=1;if(i.rateFlag>=1||i.kabCrshFlag>=1){this.deficiencyLayer.source.addFeature(n),n.setProperties({mmId:""+i.pdpId});var u="<b>"+i.pdpId+"</b>:&nbsp;",c=[];s&&c.push("Crash Rate"),l&&c.push("KAB"),u+=c.join(", "),this.$summaryList.append("<li "+a.pdpDataAttr+'="'+i.pdpId+'">'+u+"</li>")}}},t}(s.default);t.MmFlags=c,t.default=new c},function(e,t,r){"use strict";function o(e){return"number"==typeof e&&(e=e.toFixed()),t.countyLookup[e]}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=n.default("ssa");t.countyLookup={1:"Adams",2:"Ashland",3:"Barron",4:"Bayfield",5:"Brown",6:"Buffalo",7:"Burnett",8:"Calumet",9:"Chippewa",10:"Clark",11:"Columbia",12:"Crawford",13:"Dane",14:"Dodge",15:"Door",16:"Douglas",17:"Dunn",18:"Eau Claire",19:"Florence",20:"Fond du Lac",21:"Forest",22:"Grant",23:"Green",24:"Green Lake",25:"Iowa",26:"Iron",27:"Jackson",28:"Jefferson",29:"Juneau",30:"Kenosha",31:"Kewaunee",32:"La Crosse",33:"Lafayette",34:"Langlade",35:"Lincoln",36:"Manitowoc",37:"Marathon",38:"Marinette",39:"Marquette",40:"Milwaukee",41:"Monroe",42:"Oconto",43:"Oneida",44:"Outagamie",45:"Ozaukee",46:"Pepin",47:"Pierce",48:"Polk",49:"Portage",50:"Price",51:"Racine",52:"Richland",53:"Rock",54:"Rusk",55:"Saint Croix",56:"Sauk",57:"Sawyer",58:"Shawano",59:"Sheboygan",60:"Taylor",61:"Trempealeau",62:"Vernon",63:"Vilas",64:"Walworth",65:"Washburn",66:"Washington",67:"Waukesha",68:"Waupaca",69:"Waushara",70:"Winnebago",71:"Wood",73:"Menominee"},i.countyLookup=t.countyLookup,t.getCountyById=o,i.getCountyById=o},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),i=function(e){function t(){return e.call(this,"filter-controlling-criteria","filter-controlling-criteria-sub",!0)||this}return o(t,e),Object.defineProperty(t.prototype,"ccDesignSpeedOn",{get:function(){return this.valIsOn("ccDesignSpeed")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccLaneWidthOn",{get:function(){return this.valIsOn("ccLaneWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccShoulderWidthOn",{get:function(){return this.valIsOn("ccShoulderWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccHorizontalCurveOn",{get:function(){return this.valIsOn("ccHorizontalCurve")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccSuperelevationOn",{get:function(){return this.valIsOn("ccSuperelevation")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccMaximumGradeOn",{get:function(){return this.valIsOn("ccMaximumGrade")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccStoppingSightOn",{get:function(){return this.valIsOn("ccStoppingSight")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccCrossSlopeOn",{get:function(){return this.valIsOn("ccCrossSlope")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccVerticalClearanceOn",{get:function(){return this.valIsOn("ccVerticalClearance")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ccDesignLoadingOn",{get:function(){return this.valIsOn("ccDesignLoading")},enumerable:!0,configurable:!0}),t}(n.default);t.FilterControllingCriteria=i,t.default=new i},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),i=function(e){function t(){return e.call(this,"mm-flags","mm-flags-sub",!0)||this}return o(t,e),Object.defineProperty(t.prototype,"mmRateFlagOn",{get:function(){return this.valIsOn("rateFlag")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mmKabFlagOn",{get:function(){return this.valIsOn("kabCrshFlag")},enumerable:!0,configurable:!0}),t}(n.default);t.FilterMmFlag=i,t.default=new i},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(12),a=r(8),s=r(3),l=r(11),u=r(5),c=r(7),d=r(6),p=r(1),h=r(2),f=n.default("ssa.select"),y=function(e){function t(t,r){function o(e){var t="";return t+='<div style="position: relative;" class="select-picker-map-container">',t+='<select id="'+e+'"></select>',t+="</div>"}var n=this;return n=e.call(this,t.$innerContainer,r?"Ref. Point #1":"Ref. Point #2",o)||this,n._isFrom=r,n._pickerColl=t,n._selectedPdpId=void 0,n.addChangeListener(function(e){n.selectedPdpId=parseInt(e)}),n._box.keyup(function(){n.selectedPdpId!=parseInt(n.selectedValue.toString())&&n._box.trigger("change")}),n._sortedFeatures=void 0,n._segmentLayer=new a.default("",{minZoom:6,name:n._isFrom?"Start Segment":"End Segment",transform:{dataProjection:d.proj3857,featureProjection:d.proj3857},style:c.segmentLayer,visible:!1}),n._segNodeLayer=new a.default("",{style:c.segNodeStyle,minZoom:11,visible:!1}),n._segmentSelectionLayer=new a.default("",{style:new h.style.Style({stroke:new h.style.Stroke({color:n._isFrom?c.fromSelectionColor:c.toSelectionColor,width:8})}),minZoom:6,visible:!1,zIndex:n._isFrom?100:101}),n._selectBtnClass=n._isFrom?"select-seg-btn-from":"select-seg-btn-to",n._selectBtnClassTo="select-seg-btn-to",s.default.addVectorPopup(n._segmentLayer,function(e){console.log(e);var t='<table class="mm-popup-table">';return t+="<tr><td>PdpId</td><td>"+e.pdpId+"</td>;",t+='<td rowspan="5">',n._pickerColl.startEndCountySame?(t+='<input type="button" id=\''+e.pdpId+"' class=\""+n._selectBtnClass+'" value="Select Start"/>',t+='<input type="button" id=\''+e.pdpId+"' class=\""+n._selectBtnClassTo+'" value="Select End"/>'):t+='<input type="button" id=\''+e.pdpId+"' class=\""+n._selectBtnClass+'" value="Select"/>',t+="</td></tr>",t+="<tr><td>Hwy</td><td>"+e.stdName+"</td></tr>",t+="<tr><td>DivUnd</td><td>"+e.divUnd+"</td></tr>",t+="<tr><td>From</td><td>"+e.startRp+"</td></tr>",t+="<tr><td>To</td><td>"+e.endRp+"</td></tr>",t+="</table>"}),s.default.addPopupChangedFunction(function(){var e=p("."+n._selectBtnClass);if(e.length>0){var t=n;e.click(function(){t.selectedPdpId=this.id})}}),n._enabled=!1,n._layersVisible=!1,n._box.click(function(e){e.stopPropagation()}),n._box.parent("div").click(function(){if(null!=n._sortedFeatures){var e=n._sortedFeatures.getFeature(n.selectedPdpId);null!=e&&(s.default.map.getView().fit(e.getGeometry().getExtent(),s.default.map.getSize()),s.default.map.getView().setZoom(s.default.map.getView().getZoom()-2))}}),n}return o(t,e),t.prototype._processAjaxResult=function(e){var t=this;e.sort(function(e,r){var o=t._isFrom?e.properties.startRp:e.properties.endRp,n=t._isFrom?r.properties.startRp:r.properties.endRp;return o==n?0:o<n?-1:1});for(var r=0,o=e;r<o.length;r++){var n=o[r],i=n.properties;this._isFrom?this._box.append('<option value="'+i.pdpId+'">'+i.startRp+"</option>"):this._box.append('<option value="'+i.pdpId+'">'+i.endRp+"</option>")}},t.prototype.setCountyAndRoute=function(e,t,r){var o=this;if(r="number"==typeof r?r:void 0,this.selectedPdpId=void 0,this._box.html(""),this._box.addClass("refresh").removeClass("refresh"),s.default&&s.default.closePopup(),"string"==typeof e&&(e=parseInt(e)),null==t)return void(this.enabled=!1);"string"==typeof t&&(t=parseInt(t)),u.default.getSegments(e,t,function(e){if(o._segmentLayer.clear(),o._segNodeLayer.clear(),o._processAjaxResult(e.features),e.features.length>0){o.enabled=!0,o._segmentLayer.addFeatures(e);var t=o._segmentLayer.source.getFeatures();o._sortedFeatures=new i.default(t,"pdpId"),o._setExtent(),"number"==typeof r?o.selectedPdpId=r:o._box.trigger("change");for(var n=0;n<t.length;n++){var a=t[n].getGeometry().getCoordinates();if(a.length>0){var s=new h.geom.Point(a[0]),l=new h.geom.Point(a[a.length-1]);o._segNodeLayer.source.addFeature(new h.Feature(s)),o._segNodeLayer.source.addFeature(new h.Feature(l))}}}else o.enabled=!1})},t.prototype._setExtent=function(){},Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e,this._box.prop("disabled",!e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layersVisible",{get:function(){return this._layersVisible},set:function(e){this._layersVisible=e,this._isFrom?(this.segmentLayer.visible=this.layersVisible,this._segNodeLayer.visible=this.layersVisible):(this.segmentLayer.visible=this.layersVisible&&!this._pickerColl.startEndCountySame,this._segNodeLayer.visible=this.layersVisible&&!this._pickerColl.startEndCountySame),this.selectionLayer.visible=this.layersVisible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedPdpId",{get:function(){return this._selectedPdpId},set:function(e){if(s.default&&s.default.closePopup(),"string"==typeof e&&(e=parseInt(e)),e!=this._selectedPdpId&&(this._selectedPdpId=e,this.selectionLayer.source.clear(),void 0!=this._selectedPdpId)){this._box.val(this.selectedPdpId);var t=this._sortedFeatures.getFeature(this.selectedPdpId);this.selectionLayer.source.addFeature(t)}},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._box.html(""),this.selectedPdpId=void 0},Object.defineProperty(t.prototype,"segmentLayer",{get:function(){return this._segmentLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionLayer",{get:function(){return this._segmentSelectionLayer},enumerable:!0,configurable:!0}),t}(l.default);t.SegmentPicker=y,f.SegmentPicker=y,t.default=y},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(5),a=r(0),s=a.default("ssa.select"),l=function(e){function t(t,r){var o=e.call(this,t,r)||this;return i.default.getAllCounties(function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];o.box.append('<option value="'+n.id+'" '+(n.primary?"selected":"")+">"+n.name+"</option>")}o.box.trigger("change")}),o}return o(t,e),t}(n.default);t.SelectCounty=l,s.SelectStartCounty=l,t.default=l},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(5),a=r(0),s=a.default("ssa.select"),l=function(e){function t(t){return e.call(this,t,"Highway")||this}return o(t,e),t.prototype.setStartEndCounty=function(e,t,r,o){var n=this;void 0===o&&(o=!1),o="boolean"==typeof o&&o,null!=e&&void 0!=e&&null!=t&&("number"==typeof r&&(r=r.toFixed()),this.box.html(""),this.box.addClass("refresh").removeClass("refresh"),"string"==typeof e&&(e=parseInt(e)),"string"==typeof t&&(t=parseInt(t)),"string"==typeof r&&(r=parseInt(r)),i.default.getHwyByStartEndCounty(e,t,function(e){if(e.length>0){e.sort(function(e,t){var r=e.name,o=t.name;return r==o?0:r>o?1:-1});for(var t=0,i=e;t<i.length;t++){var a=i[t];n.box.append('<option value="'+a.id+'" '+(a.primary?"selected":"")+">"+a.name+"</option>")}r&&n.box.val(r.toFixed()),r&&!o||n.box.trigger("change"),n.box.prop("disabled",!1)}else n.box.prop("disabled",!0),n.box.trigger("change")}))},t}(n.default);t.SelectHighway=l,s.SelectHighway=l,t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(26),n=r(27);window.SsaMapCreate=o.SsaMapCreate,window.SsaMapView=n.SsaMapView;try{glob.SsaMapCreate=o.SsaMapCreate,glob.SsaMapView=n.SsaMapView}catch(e){var i={};i.SsaMapCreate=o.SsaMapCreate,i.SsaMapView=n.SsaMapView}}]);
//# sourceMappingURL=ssaApps.js.map